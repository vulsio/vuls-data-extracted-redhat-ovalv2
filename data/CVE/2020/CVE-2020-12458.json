{
	"id": "CVE-2020-12458",
	"vulnerabilities": [
		{
			"content": {
				"id": "CVE-2020-12458",
				"title": "CVE-2020-12458 grafana: information disclosure through world-readable /var/lib/grafana/grafana.db (low)",
				"description": "DOCUMENTATION: An information-disclosure flaw was found in the way Grafana set permissions for the database directory and file. This flaw allows a local attacker access to potentially sensitive information such as cleartext or encrypted datasource passwords from /var/lib/grafana/grafana.db.\n            STATEMENT: The versions of grafana shipped with Red Hat Gluster Storage 3, Red Hat Ceph Storage 3 and 4 sets the world readable permissions on grafana database directory and file, hence affected by this vulnerability.\n \nIn both OpenShift Container Platform (OCP) and OpenShift ServiceMesh (OSSM), the grafana containers set their database files to world readable. However, as it's run in a container image with SELinux MCS labels this prevents other processes on the host from reading it. Therefore, for both (OCP and OSSM) the impact is low.\n            MITIGATION: Manually change the directory and files permissions to remove readable bits for others:\n\n# chmod 750 /var/lib/grafana\n# chmod 640 /var/lib/grafana/grafana.db\n# chown grafana:grafana /var/lib/grafana/grafana.db",
				"severity": [
					{
						"type": "vendor",
						"source": "secalert@redhat.com",
						"vendor": "low"
					},
					{
						"type": "cvss_v31",
						"source": "secalert@redhat.com",
						"cvss_v31": {
							"vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
							"base_score": 6.2,
							"base_severity": "MEDIUM",
							"temporal_score": 6.2,
							"temporal_severity": "MEDIUM",
							"environmental_score": 6.2,
							"environmental_severity": "MEDIUM"
						}
					}
				],
				"cwe": [
					{
						"source": "secalert@redhat.com",
						"cwe": [
							"CWE-732"
						]
					}
				],
				"references": [
					{
						"source": "secalert@redhat.com",
						"url": "https://access.redhat.com/security/cve/CVE-2020-12458"
					}
				]
			},
			"segments": [
				{
					"ecosystem": "redhat:8",
					"tag": "openshift-service-mesh-1.0-including-unpatched"
				},
				{
					"ecosystem": "redhat:8",
					"tag": "openshift-service-mesh-1.1-including-unpatched"
				}
			]
		},
		{
			"content": {
				"id": "CVE-2020-12458",
				"title": "CVE-2020-12458 grafana: information disclosure through world-readable /var/lib/grafana/grafana.db (moderate)",
				"description": "DOCUMENTATION: An information-disclosure flaw was found in the way Grafana set permissions for the database directory and file. This flaw allows a local attacker access to potentially sensitive information such as cleartext or encrypted datasource passwords from /var/lib/grafana/grafana.db.\n            STATEMENT: The versions of grafana shipped with Red Hat Gluster Storage 3, Red Hat Ceph Storage 3 and 4 sets the world readable permissions on grafana database directory and file, hence affected by this vulnerability.\n \nIn both OpenShift Container Platform (OCP) and OpenShift ServiceMesh (OSSM), the grafana containers set their database files to world readable. However, as it's run in a container image with SELinux MCS labels this prevents other processes on the host from reading it. Therefore, for both (OCP and OSSM) the impact is low.\n            MITIGATION: Manually change the directory and files permissions to remove readable bits for others:\n\n# chmod 750 /var/lib/grafana\n# chmod 640 /var/lib/grafana/grafana.db\n# chown grafana:grafana /var/lib/grafana/grafana.db",
				"severity": [
					{
						"type": "vendor",
						"source": "secalert@redhat.com",
						"vendor": "moderate"
					},
					{
						"type": "cvss_v31",
						"source": "secalert@redhat.com",
						"cvss_v31": {
							"vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
							"base_score": 6.2,
							"base_severity": "MEDIUM",
							"temporal_score": 6.2,
							"temporal_severity": "MEDIUM",
							"environmental_score": 6.2,
							"environmental_severity": "MEDIUM"
						}
					}
				],
				"cwe": [
					{
						"source": "secalert@redhat.com",
						"cwe": [
							"CWE-732"
						]
					}
				],
				"references": [
					{
						"source": "secalert@redhat.com",
						"url": "https://access.redhat.com/security/cve/CVE-2020-12458"
					}
				]
			},
			"segments": [
				{
					"ecosystem": "redhat:7",
					"tag": "storage-ceph-2-including-unpatched"
				},
				{
					"ecosystem": "redhat:7",
					"tag": "storage-ceph-3-including-unpatched"
				}
			]
		}
	],
	"detections": [
		{
			"ecosystem": "redhat:7",
			"conditions": [
				{
					"criteria": {
						"operator": "AND",
						"criterions": [
							{
								"type": "version",
								"version": {
									"vulnerable": true,
									"fix_status": {
										"class": "unfixed",
										"vendor": "Will not fix"
									},
									"package": {
										"name": "grafana",
										"repositories": [
											"rhel-7-server-rhceph-3-for-power-le-mon-debug-rpms",
											"rhel-7-server-rhceph-3-for-power-le-mon-els-debug-rpms",
											"rhel-7-server-rhceph-3-for-power-le-mon-els-rpms",
											"rhel-7-server-rhceph-3-for-power-le-mon-els-source-rpms",
											"rhel-7-server-rhceph-3-for-power-le-mon-rpms",
											"rhel-7-server-rhceph-3-for-power-le-mon-source-rpms",
											"rhel-7-server-rhceph-3-for-power-le-osd-debug-rpms",
											"rhel-7-server-rhceph-3-for-power-le-osd-els-debug-rpms",
											"rhel-7-server-rhceph-3-for-power-le-osd-els-rpms",
											"rhel-7-server-rhceph-3-for-power-le-osd-els-source-rpms",
											"rhel-7-server-rhceph-3-for-power-le-osd-rpms",
											"rhel-7-server-rhceph-3-for-power-le-osd-source-rpms",
											"rhel-7-server-rhceph-3-for-power-le-tools-debug-rpms",
											"rhel-7-server-rhceph-3-for-power-le-tools-els-debug-rpms",
											"rhel-7-server-rhceph-3-for-power-le-tools-els-rpms",
											"rhel-7-server-rhceph-3-for-power-le-tools-els-source-rpms",
											"rhel-7-server-rhceph-3-for-power-le-tools-rpms",
											"rhel-7-server-rhceph-3-for-power-le-tools-source-rpms",
											"rhel-7-server-rhceph-3-mon-debug-rpms",
											"rhel-7-server-rhceph-3-mon-els-debug-rpms",
											"rhel-7-server-rhceph-3-mon-els-rpms",
											"rhel-7-server-rhceph-3-mon-els-source-rpms",
											"rhel-7-server-rhceph-3-mon-rpms",
											"rhel-7-server-rhceph-3-mon-source-rpms",
											"rhel-7-server-rhceph-3-osd-debug-rpms",
											"rhel-7-server-rhceph-3-osd-els-debug-rpms",
											"rhel-7-server-rhceph-3-osd-els-rpms",
											"rhel-7-server-rhceph-3-osd-els-source-rpms",
											"rhel-7-server-rhceph-3-osd-rpms",
											"rhel-7-server-rhceph-3-osd-source-rpms",
											"rhel-7-server-rhceph-3-textonly-rpms",
											"rhel-7-server-rhceph-3-tools-debug-rpms",
											"rhel-7-server-rhceph-3-tools-els-debug-rpms",
											"rhel-7-server-rhceph-3-tools-els-rpms",
											"rhel-7-server-rhceph-3-tools-els-source-rpms",
											"rhel-7-server-rhceph-3-tools-rpms",
											"rhel-7-server-rhceph-3-tools-source-rpms"
										]
									}
								}
							}
						]
					},
					"tag": "storage-ceph-3-including-unpatched"
				},
				{
					"criteria": {
						"operator": "AND",
						"criterions": [
							{
								"type": "version",
								"version": {
									"vulnerable": true,
									"fix_status": {
										"class": "unfixed",
										"vendor": "Out of support scope"
									},
									"package": {
										"name": "grafana",
										"repositories": [
											"rhel-7-desktop-rhceph-2-tools-debug-rpms",
											"rhel-7-desktop-rhceph-2-tools-rpms",
											"rhel-7-desktop-rhceph-2-tools-source-rpms",
											"rhel-7-for-hpc-node-rhceph-2-tools-debug-rpms",
											"rhel-7-for-hpc-node-rhceph-2-tools-rpms",
											"rhel-7-for-hpc-node-rhceph-2-tools-source-rpms",
											"rhel-7-server-rhceph-2-mon-debug-rpms",
											"rhel-7-server-rhceph-2-mon-rpms",
											"rhel-7-server-rhceph-2-mon-source-rpms",
											"rhel-7-server-rhceph-2-osd-debug-rpms",
											"rhel-7-server-rhceph-2-osd-rpms",
											"rhel-7-server-rhceph-2-osd-source-rpms",
											"rhel-7-server-rhceph-2-textonly-rpms",
											"rhel-7-server-rhceph-2-tools-debug-rpms",
											"rhel-7-server-rhceph-2-tools-rpms",
											"rhel-7-server-rhceph-2-tools-source-rpms",
											"rhel-7-workstation-rhceph-2-tools-debug-rpms",
											"rhel-7-workstation-rhceph-2-tools-rpms",
											"rhel-7-workstation-rhceph-2-tools-source-rpms"
										]
									}
								}
							}
						]
					},
					"tag": "storage-ceph-2-including-unpatched"
				}
			]
		},
		{
			"ecosystem": "redhat:8",
			"conditions": [
				{
					"criteria": {
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"type": "version",
										"version": {
											"vulnerable": true,
											"fix_status": {
												"class": "unfixed",
												"vendor": "Affected"
											},
											"package": {
												"name": "servicemesh-grafana",
												"repositories": [
													"ossm-1.1-for-rhel-8-ppc64le-debug-rpms",
													"ossm-1.1-for-rhel-8-ppc64le-rpms",
													"ossm-1.1-for-rhel-8-ppc64le-source-rpms",
													"ossm-1.1-for-rhel-8-s390x-debug-rpms",
													"ossm-1.1-for-rhel-8-s390x-rpms",
													"ossm-1.1-for-rhel-8-s390x-source-rpms",
													"ossm-1.1-for-rhel-8-x86_64-debug-rpms",
													"ossm-1.1-for-rhel-8-x86_64-rpms",
													"ossm-1.1-for-rhel-8-x86_64-source-rpms"
												]
											}
										}
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"type": "version",
										"version": {
											"vulnerable": true,
											"fix_status": {
												"class": "unfixed",
												"vendor": "Affected"
											},
											"package": {
												"name": "servicemesh-grafana-prometheus",
												"repositories": [
													"ossm-1.1-for-rhel-8-ppc64le-debug-rpms",
													"ossm-1.1-for-rhel-8-ppc64le-rpms",
													"ossm-1.1-for-rhel-8-ppc64le-source-rpms",
													"ossm-1.1-for-rhel-8-s390x-debug-rpms",
													"ossm-1.1-for-rhel-8-s390x-rpms",
													"ossm-1.1-for-rhel-8-s390x-source-rpms",
													"ossm-1.1-for-rhel-8-x86_64-debug-rpms",
													"ossm-1.1-for-rhel-8-x86_64-rpms",
													"ossm-1.1-for-rhel-8-x86_64-source-rpms"
												]
											}
										}
									}
								]
							}
						]
					},
					"tag": "openshift-service-mesh-1.1-including-unpatched"
				},
				{
					"criteria": {
						"operator": "OR",
						"criterias": [
							{
								"operator": "AND",
								"criterions": [
									{
										"type": "version",
										"version": {
											"vulnerable": true,
											"fix_status": {
												"class": "unfixed",
												"vendor": "Affected"
											},
											"package": {
												"name": "servicemesh-grafana",
												"repositories": [
													"ossm-1.0-for-rhel-8-x86_64-debug-rpms",
													"ossm-1.0-for-rhel-8-x86_64-rpms",
													"ossm-1.0-for-rhel-8-x86_64-source-rpms"
												]
											}
										}
									}
								]
							},
							{
								"operator": "AND",
								"criterions": [
									{
										"type": "version",
										"version": {
											"vulnerable": true,
											"fix_status": {
												"class": "unfixed",
												"vendor": "Affected"
											},
											"package": {
												"name": "servicemesh-grafana-prometheus",
												"repositories": [
													"ossm-1.0-for-rhel-8-x86_64-debug-rpms",
													"ossm-1.0-for-rhel-8-x86_64-rpms",
													"ossm-1.0-for-rhel-8-x86_64-source-rpms"
												]
											}
										}
									}
								]
							}
						]
					},
					"tag": "openshift-service-mesh-1.0-including-unpatched"
				}
			]
		}
	],
	"data_source": {
		"id": "redhat-ovalv2",
		"raws": [
			"vuls-data-raw-redhat-oval-repository-to-cpe/repository-to-cpe.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-2-including-unpatched/definitions/oval:com.redhat.cve:def:202012458.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-2-including-unpatched/objects/rpminfo_object/oval:com.redhat.cve:obj:20181000816001.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-2-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:20181000816001.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-2-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:20181000816002.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-2-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:20137459003.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-2-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:20137459004.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-3-including-unpatched/definitions/oval:com.redhat.cve:def:202012458.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-3-including-unpatched/objects/rpminfo_object/oval:com.redhat.cve:obj:20181000816001.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-3-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:20181000816001.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-3-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:20181000816002.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-3-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:201610745003.json",
			"vuls-data-raw-redhat-ovalv2/7/storage-ceph-3-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:201610745004.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/definitions/oval:com.redhat.cve:def:202012458.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/objects/rpminfo_object/oval:com.redhat.cve:obj:201818624001.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/objects/rpminfo_object/oval:com.redhat.cve:obj:201818624002.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624001.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624002.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624003.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624004.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:201818624005.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.0-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:201818624006.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/definitions/oval:com.redhat.cve:def:202012458.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/objects/rpminfo_object/oval:com.redhat.cve:obj:201818624001.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/objects/rpminfo_object/oval:com.redhat.cve:obj:201818624002.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624001.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624002.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624003.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/tests/rpminfo_test/oval:com.redhat.cve:tst:201818624004.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:201818624005.json",
			"vuls-data-raw-redhat-ovalv2/8/openshift-service-mesh-1.1-including-unpatched/tests/rpmverifyfile_test/oval:com.redhat.cve:tst:201818624006.json"
		]
	}
}
